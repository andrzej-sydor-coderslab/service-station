<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Course of the service</title>
    <link rel="stylesheet" th:href="@{css/myStyle.css}" type="text/css">
</head>
<body>
<div th:include="header.html"></div>
<div class="main">

    <h3 class="title">Course of the service</h3>

    <p><span>Title:</span> <span th:text="${order.title}"></span></p>

    <span style="font-weight: bold">Initial diagnosis:</span>
    <p><textarea disabled th:field="*{order.initialDiagnosis}" rows="5" cols="60"/></p>

    <p><span>Vehicle:</span> <span th:text="${order.vehicle.brand + ' ' + order.vehicle.model + ' reg:' +order.vehicle.plateNumber}"></span></p>

    <p><span>Planned repair start:</span> <span th:text="${order.plannedRepairStart}"></span></p>

    <p><span>Actual repair start:</span>
        <data class="noValueStyle" th:if="${order.actualRepairStart==null}">Repair not started</data>
        <span th:if="${order.actualRepairStart!=null}"> <data th:text="${order.actualRepairStart}"></data> </span></p>

    <p><span>Status:</span> <span th:text="${order.status.getDescription()}"></span></p>

    <p><a th:href="@{'/orders/repair-progress-report-update/' + ${order.id}}" class="editLink">Repair progress report</a></p>

    <div th:if="${order.cancelReason!=null}"><span style="font-weight: bold">Cancellation reason: </span>
        <p><textarea disabled th:field="*{order.cancelReason}" rows="5" cols="60"/></p></div>

    <p><span>Price of service:</span> <span
            th:if="${order.priceOfService==null}"><data
            class="noValueStyle">To be set at the end of the service</data></span><span
            th:text="${order.priceOfService}"></span></p>


    <p><span>Employee(s) assigned to order:</span>
    <ul>
        <li th:each="employee : ${employeesAssignedToOrder}">
            <a th:text="${employee.firstName + ' ' + employee.lastName}"
               th:href="@{'/employees/details/'+${employee.id}}"></a>
        </li>
    </ul>
    </p>

    <p><span>Parts: </span><span class="noValueStyle"
                                 th:if="${order.parts.size()<1}">No parts added to this order</span>
        <p><a th:href="@{'/orders/add-part-to-order/' + ${order.id}}">Add parts</a></p>
    <div th:if="${order.parts.size()>0}">
        <table border="1" class="parts">
            <thead>
            <tr>
                <td>Name</td>
                <td>Price</td>
                <td>Quantity</td>
                <td></td>
            </tr>
            </thead>
            <tr th:each="part : ${order.parts}">
                <td th:text="${part.name}"></td>
                <td th:text="${part.price}"></td>
                <td th:text="${part.quantity}"></td>
                <td><a th:href="@{'/orders/delete-part-then-back-to-order/' + ${part.id} + '/' + ${order.id}}">
                    <button class="minus"> -</button>
                </a></td>
            </tr>
        </table>
    </div>
    </p>

    <p><span>Invoices:</span> <span class="noValueStyle"
                                    th:if="${order.invoices.size()==0}">
            No invoice attached to this order</span></p>
    <p><a th:href="@{'/orders/upload-invoice/' + ${order.id}}">Upload invoice</a></p>

    <div>
        <ul>
            <li th:each="image : ${order.invoices}" class="images">
                <a th:href="@{'/orders/full-screen-invoice/' + ${image.id}}"><img height="100" width="100" alt="sample"
                                                                                  th:src="*{'data:image/png;base64,' + image.code}"/></a><a
                    th:href="@{'/orders/delete-invoice/' + ${image.id} + '/' + ${order.id}}">
                <button class="minus"> -</button>
            </a></li>
        </ul>
    </div>

    <p><span>Created:</span> <span th:text="${order.created}"></span></p>

    <p><span>Last update:</span> <span th:text="${order.updated}"></span></p>

    <p th:if="${order.status.id==1}"><a th:href="@{'/orders/start-repair/'+${order.id}}">Start repair</a> /
        <a th:href="@{'/orders/cancel-repair/' + ${order.id}}">Cancel repair</a></p>

    <p th:if="${order.status.id==2}"><a th:href="@{'/orders/finish-repair/' + ${order.id}}">Finish repair</a> /
        <a th:href="@{'/orders/cancel-repair/' + ${order.id}}">Cancel repair</a></p>

    <p><a class="editLink" th:href="@{'/orders/update/' + ${order.id}}">Edit mode</a></p>

    <p><a class="deleteLink" th:href="@{'/orders/delete/' + ${order.id}}">Delete order</a></p>
</div>
</body>
</html>